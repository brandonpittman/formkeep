#!/usr/bin/env ruby

require 'formkeep'
require 'slop'

opts = Slop.parse do
  banner "Usage: formkeep check FORM"
  on :h, :help, "Display help"
  on :v, :version, "Display version" do
    puts Formkeep::VERSION
    exit
  end

  command 'check' do
    banner <<-EOF
    Usage: formkeep check FORM

    Please make sure you have a valid Formkeep API endpoint saved in ~/.formkeep.yaml
    EOF
    run do |opts, args|
      unless args.empty?
        form = Formkeep::Form.new(args[0])
        puts form.unread_submissions.length
      else
        puts opts
      end
    end
  end
end

puts opts unless ARGV[0] == 'check'
